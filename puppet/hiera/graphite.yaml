# Copyright 2014 Acquia, Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
---
classes:
  - roles::graphite

limits::fragment:
  "www-data/-/memlock":
    value: 'unlimited'
    file: '/etc/security/limits.d/graphite.conf'
  "www-data/-/nofile":
    value: '100000'
    file: '/etc/security/limits.d/graphite.conf'
  "www-data/-/as":
    value: 'unlimited'
    file: '/etc/security/limits.d/graphite.conf'
  "www-data/-/nproc":
    value: '8096'
    file: '/etc/security/limits.d/graphite.conf'

sumologic::paths:
  console:
    :path: '/mnt/log/carbon-daemon/console.log'
    :date_format: 'dd/MM/yyyy HH:mm:ss'
  creates:
    :path: '/mnt/log/carbon-daemon/creates.log'
    :date_format: 'dd/MM/yyyy HH:mm:ss'
  query:
    :path: '/mnt/log/carbon-daemon/query.log'
    :date_format: 'dd/MM/yyyy HH:mm:ss'
  writes:
    :path: '/mnt/log/carbon-daemon/writes.log'
    :date_format: 'dd/MM/yyyy HH:mm:ss'
  access:
    :path: '/mnt/log/graphite/webapp/access.log'
    :date_format: 'dd/MMM/yyyy:HH:mm:ss'
  error:
    :path: '/mnt/log/graphite/webapp/error.log'
    :date_format: 'dd/MMM/yyyy HH:mm:ss'
  exception:
    :path: '/mnt/log/graphite/webapp/exception.log'
    :date_format: 'dd/MMM/yyyy HH:mm:ss'
  rollups:
    :path: '/mnt/log/cassandra-rollup.log'
    :date_format: 'MMM DD HH:mm:ss'

sumologic::category: 'platform_health'
